!function(){function e(e){function r(){for(;c=d<a.length&&e>l;){var t=d++,r=a[t],i=n.call(r,1);i.push(o(t)),++l,r[0].apply(null,i)}}function o(e){return function(t,n){--l,null==p&&(null!=t?(p=t,d=f=0/0,i()):(a[e]=n,--f?c||r():i()))}}function i(){null!=p?h(p):s?h(p,a):h.apply(null,[p].concat(a))}var u,c,s,a=[],d=0,l=0,f=0,p=null,h=t;return e||(e=1/0),u={defer:function(){return p||(a.push(arguments),++f,r()),u},await:function(e){return h=e,s=!1,f||i(),u},awaitAll:function(e){return h=e,s=!0,f||i(),u}}}function t(){}"undefined"==typeof module?self.queue=e:module.exports=e,e.version="1.0.4";var n=[].slice}(),function(){Robin.Reactor={_q:queue(1),_verbs:["updated","created","destroyed","flushed","batched"],process:function(e,t,n){return this._verbs.indexOf(e)>-1?"batched"===e?this._batched(t,n):this._enqueue(e,t,n):Batman.developer.warn("unrecognized verb: "+e)},_execute:function(e,t,n){return Batman.developer.log(""+e+" "+t.name+" => "+JSON.stringify(n)),this["_"+e](t,n)},_enqueue:function(e,t,n){var r=this;return this._q.defer(function(o){return r._execute(e,t,n),o()})},_removeRecord:function(e,t){return e.get("loaded").remove(t),t.get("lifecycle").destroyed()},_initOrUpdateRecord:function(e,t){return e._makeOrFindRecordFromData(t)},_findRecord:function(e,t){return e._loadIdentity(t.id)},_flushed:function(e,t){var n,r,o,i,u,c,s;for(n=t.key,u=t.value,i=e.get("loaded").indexedBy(n).get(u).toArray(),c=0,s=i.length;s>c;c++)o=i[c],this._removeRecord(e,o);return n===e.get("primaryKey")?e.find(u,function(){}):(r={},r[""+n]=u,e.load(r))},_batched:function(e,t){var n,r,o,i;if(null!=t){for(Batman.developer.log("batched ("+t.length+")"),i=[],r=0,o=t.length;o>r;r++)n=t[r],i.push(this._enqueue(n[0],e,n[1]));return i}},_created:function(e,t){return this._initOrUpdateRecord(e,t)},_updated:function(e,t){var n;return n=this._findRecord(e,t),null!=n?this._initOrUpdateRecord(e,t):void 0},_destroyed:function(e,t){var n;return n=this._findRecord(e,t),null!=n?this._removeRecord(e,n):void 0}}}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function r(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Robin.AdapterMethods={subscribe:function(){var e=this;return Robin.observeAndFire("socket",function(t){return null!=t?(e.socket=t,e._subscribeNow()):void 0})},_subscribeNow:function(){var e,t,n,r,o,i,u=this;for(e=this.model.storageKey,Batman.developer.log("Subscribing to /"+e+"..."),o=Robin.Reactor._verbs,i=[],n=0,r=o.length;r>n;n++)t=o[n],i.push(function(t){return u.socket.subscribe("/"+e+"/"+t,function(e){return u._react(t,e)})}(t));return i},_react:function(e,t){return Robin.Reactor.process(e,this.model,t)}},Robin.Adapter=function(e){function n(e){n.__super__.constructor.call(this,e),this.subscribe()}return t(n,e),n.mixin(Robin.AdapterMethods),n}(Batman.RailsStorage)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function r(){this.constructor=e}for(var o in n)t.call(n,o)&&(e[o]=n[o]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};this.Robin=function(t){function r(){return e=r.__super__.constructor.apply(this,arguments)}return n(r,t),r.connect=function(e){return this.set("socket",e),this.fire("socket:ready")},r}(Batman.Object),window.Robin=Robin}.call(this);